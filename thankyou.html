<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thank you</title>
    <link rel="stylesheet" href="css/lastpage.css" />
    <script>
      function toggleMute() {
        const audio = document.getElementById("background-music");
        const muteBtn = document.getElementById("mute-btn");
        
        if (audio.muted) {
          audio.muted = false;
          muteBtn.textContent = "ðŸ”Š";
          localStorage.setItem("musicMuted", "false");
        } else {
          audio.muted = true;
          muteBtn.textContent = "ðŸ”‡";
          localStorage.setItem("musicMuted", "true");
        }
      }

      // Save playback state before leaving page
      function savePlaybackState() {
        const audio = document.getElementById("background-music");
        if (audio) {
          localStorage.setItem("musicCurrentTime", audio.currentTime);
          localStorage.setItem("musicPlaying", !audio.paused);
        }
      }

      // Restore playback state on page load
      function restorePlaybackState() {
        const audio = document.getElementById("background-music");
        if (!audio) return;

        // Set volume to 20%
        audio.volume = 0.2;

        // Restore mute state
        const muted = localStorage.getItem("musicMuted") === "true";
        audio.muted = muted;
        const muteBtn = document.getElementById("mute-btn");
        if (muteBtn) {
          muteBtn.textContent = muted ? "ðŸ”‡" : "ðŸ”Š";
        }

        // Restore playback time and state
        const savedTime = parseFloat(localStorage.getItem("musicCurrentTime")) || 0;
        const wasPlaying = localStorage.getItem("musicPlaying") === "true";

        audio.currentTime = savedTime;

        if (wasPlaying && audio.paused) {
          audio.play().catch(function(error) {
            console.log("Autoplay prevented:", error);
          });
        }
      }

      // Try to play audio when page loads and on any user interaction
      function tryPlayAudio() {
        const audio = document.getElementById("background-music");
        if (audio && audio.paused) {
          audio.play().catch(function(error) {
            console.log("Autoplay prevented:", error);
          });
          localStorage.setItem("musicPlaying", "true");
        }
      }

      // Update playback time periodically
      setInterval(function() {
        const audio = document.getElementById("background-music");
        if (audio && !audio.paused) {
          localStorage.setItem("musicCurrentTime", audio.currentTime);
          localStorage.setItem("musicPlaying", "true");
        }
      }, 500);

      window.addEventListener("load", function() {
        const audio = document.getElementById("background-music");
        if (audio) {
          audio.volume = 0.2; // Set volume to 20%
        }
        restorePlaybackState();
        tryPlayAudio();
      });
      
      // Save state before page unload
      window.addEventListener("beforeunload", savePlaybackState);
      
      // Try to play on user interaction
      document.addEventListener("click", tryPlayAudio);
      document.addEventListener("touchstart", tryPlayAudio);
      document.addEventListener("keydown", tryPlayAudio);
    </script>
  </head>
  <body>
    <audio id="background-music" autoplay loop volume="0.2">
      <source src="Halintulad.mp3" type="audio/mpeg" />
      Your browser does not support the audio element.
    </audio>

    <button id="mute-btn" class="mute-button" onclick="toggleMute()">ðŸ”Š</button>

    <div id="thankyou"><b>Thank you</b></div>

    <img height="300px" id="rizz" src="nailong.gif" alt="nailong" class="responsive" />
    <br />
    <h1>WAITTTTT!</h1>
    <button class="button" onclick="location.href='message.html'">
      Click me hehehe... 
    </button>
  </body>
</html>
